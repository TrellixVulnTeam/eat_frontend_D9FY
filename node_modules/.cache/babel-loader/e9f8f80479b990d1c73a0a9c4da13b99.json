{"remainingRequest":"C:\\Users\\shani.VOICESENSE\\Documents\\CodingAcademy\\Ex-Submissions\\Shani Herzinger\\eat-with\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\shani.VOICESENSE\\Documents\\CodingAcademy\\Ex-Submissions\\Shani Herzinger\\eat-with\\frontend\\src\\services\\socket.service.js","dependencies":[{"path":"C:\\Users\\shani.VOICESENSE\\Documents\\CodingAcademy\\Ex-Submissions\\Shani Herzinger\\eat-with\\frontend\\src\\services\\socket.service.js","mtime":1626081821000},{"path":"C:\\Users\\shani.VOICESENSE\\Documents\\CodingAcademy\\Ex-Submissions\\Shani Herzinger\\eat-with\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626260724928},{"path":"C:\\Users\\shani.VOICESENSE\\Documents\\CodingAcademy\\Ex-Submissions\\Shani Herzinger\\eat-with\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1626260715884}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGlvIGZyb20gJ3NvY2tldC5pby1jbGllbnQnOwppbXBvcnQgeyBodHRwU2VydmljZSB9IGZyb20gJy4vaHR0cC5zZXJ2aWNlJzsKZXhwb3J0IGNvbnN0IFNPQ0tFVF9FTUlUX1VTRVJfV0FUQ0ggPSAndXNlci13YXRjaCc7CmV4cG9ydCBjb25zdCBTT0NLRVRfRVZFTlRfVVNFUl9VUERBVEVEID0gJ3VzZXItdXBkYXRlZCc7CmV4cG9ydCBjb25zdCBTT0NLRVRfRVZFTlRfUkVWSUVXX0FEREVEID0gJ3Jldmlldy1hZGRlZCc7CmV4cG9ydCBjb25zdCBTT0NLRVRfRVZFTlRfUkVWSUVXX0FCT1VUX1lPVSA9ICdyZXZpZXctYWJvdXQteW91JzsKY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnJyA6ICcvL2xvY2FsaG9zdDozMDMwJzsgLy8gZXhwb3J0IGNvbnN0IHNvY2tldFNlcnZpY2UgPSBjcmVhdGVTb2NrZXRTZXJ2aWNlKCkKCmV4cG9ydCBjb25zdCBzb2NrZXRTZXJ2aWNlID0gY3JlYXRlRHVtbXlTb2NrZXRTZXJ2aWNlKCk7CndpbmRvdy5zb2NrZXRTZXJ2aWNlID0gc29ja2V0U2VydmljZTsgLy8gdmFyIHNvY2tldElzUmVhZHkgPSBmYWxzZTsKCnNvY2tldFNlcnZpY2Uuc2V0dXAoKTsKCmZ1bmN0aW9uIGNyZWF0ZVNvY2tldFNlcnZpY2UoKSB7CiAgdmFyIHNvY2tldCA9IG51bGw7CiAgY29uc3Qgc29ja2V0U2VydmljZSA9IHsKICAgIGFzeW5jIHNldHVwKCkgewogICAgICAvLyBZYXJvbkI6IE5lZWQgdG8gc2VuZCBhIGR1bW15IGFqYXggcmVxdWVzdCBhcyB0byBzZXR1cCB0aGUgc29ja2V0LXNlc3Npb24gY29ycmVjdGx5CiAgICAgIC8vIGF3YWl0IGh0dHBTZXJ2aWNlLmdldCgnc2V0dXAtc2Vzc2lvbicpCiAgICAgIC8vIHNvY2tldCA9IGlvKGJhc2VVcmwsIHsgcmVjb25uZWN0aW9uOiBmYWxzZX0pCiAgICAgIHNvY2tldCA9IGlvKGJhc2VVcmwpOyAvLyBzb2NrZXRJc1JlYWR5ID0gdHJ1ZTsKICAgIH0sCgogICAgb24oZXZlbnROYW1lLCBjYikgewogICAgICBzb2NrZXQub24oZXZlbnROYW1lLCBjYik7CiAgICB9LAoKICAgIG9mZihldmVudE5hbWUsIGNiID0gbnVsbCkgewogICAgICBpZiAoIXNvY2tldCkgcmV0dXJuOwogICAgICBpZiAoIWNiKSBzb2NrZXQucmVtb3ZlQWxsTGlzdGVuZXJzKGV2ZW50TmFtZSk7ZWxzZSBzb2NrZXQub2ZmKGV2ZW50TmFtZSwgY2IpOwogICAgfSwKCiAgICBlbWl0KGV2ZW50TmFtZSwgZGF0YSkgewogICAgICBzb2NrZXQuZW1pdChldmVudE5hbWUsIGRhdGEpOwogICAgfSwKCiAgICB0ZXJtaW5hdGUoKSB7CiAgICAgIHNvY2tldCA9IG51bGw7CiAgICB9CgogIH07CiAgcmV0dXJuIHNvY2tldFNlcnZpY2U7Cn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCgoKZnVuY3Rpb24gY3JlYXRlRHVtbXlTb2NrZXRTZXJ2aWNlKCkgewogIHZhciBsaXN0ZW5lcnNNYXAgPSB7fTsKICBjb25zdCBzb2NrZXRTZXJ2aWNlID0gewogICAgbGlzdGVuZXJzTWFwLAoKICAgIHNldHVwKCkgewogICAgICBsaXN0ZW5lcnNNYXAgPSB7fTsKICAgIH0sCgogICAgdGVybWluYXRlKCkgewogICAgICB0aGlzLnNldHVwKCk7CiAgICB9LAoKICAgIG9uKGV2ZW50TmFtZSwgY2IpIHsKICAgICAgbGlzdGVuZXJzTWFwW2V2ZW50TmFtZV0gPSBbLi4uKGxpc3RlbmVyc01hcFtldmVudE5hbWVdIHx8IFtdKSwgY2JdOwogICAgfSwKCiAgICBvZmYoZXZlbnROYW1lLCBjYikgewogICAgICBpZiAoIWxpc3RlbmVyc01hcFtldmVudE5hbWVdKSByZXR1cm47CiAgICAgIGlmICghY2IpIGRlbGV0ZSBsaXN0ZW5lcnNNYXBbZXZlbnROYW1lXTtlbHNlIGxpc3RlbmVyc01hcFtldmVudE5hbWVdID0gbGlzdGVuZXJzTWFwW2V2ZW50TmFtZV0uZmlsdGVyKGwgPT4gbCAhPT0gY2IpOwogICAgfSwKCiAgICBlbWl0KGV2ZW50TmFtZSwgZGF0YSkgewogICAgICBpZiAoIWxpc3RlbmVyc01hcFtldmVudE5hbWVdKSByZXR1cm47CiAgICAgIGxpc3RlbmVyc01hcFtldmVudE5hbWVdLmZvckVhY2gobGlzdGVuZXIgPT4gewogICAgICAgIGxpc3RlbmVyKGRhdGEpOwogICAgICB9KTsKICAgIH0sCgogICAgZGVidWdNc2coKSB7CiAgICAgIHRoaXMuZW1pdCgnY2hhdCBhZGRNc2cnLCB7CiAgICAgICAgZnJvbTogJ1NvbWVvbmUnLAogICAgICAgIHR4dDogJ0FoYSBpdCB3b3JrZWQhJwogICAgICB9KTsKICAgIH0KCiAgfTsKICByZXR1cm4gc29ja2V0U2VydmljZTsKfSAvLyBCYXNpYyBUZXN0cwovLyBmdW5jdGlvbiBjYih4KSB7Y29uc29sZS5sb2coeCl9Ci8vIHNvY2tldFNlcnZpY2Uub24oJ2JhYmEnLCBjYikKLy8gc29ja2V0U2VydmljZS5lbWl0KCdiYWJhJywgJ0RBVEEnKQovLyBzb2NrZXRTZXJ2aWNlLm9mZignYmFiYScsIGNiKQ=="},{"version":3,"sources":["C:/Users/shani.VOICESENSE/Documents/CodingAcademy/Ex-Submissions/Shani Herzinger/eat-with/frontend/src/services/socket.service.js"],"names":["io","httpService","SOCKET_EMIT_USER_WATCH","SOCKET_EVENT_USER_UPDATED","SOCKET_EVENT_REVIEW_ADDED","SOCKET_EVENT_REVIEW_ABOUT_YOU","baseUrl","process","env","NODE_ENV","socketService","createDummySocketService","window","setup","createSocketService","socket","on","eventName","cb","off","removeAllListeners","emit","data","terminate","listenersMap","filter","l","forEach","listener","debugMsg","from","txt"],"mappings":"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","sourcesContent":["import io from 'socket.io-client'\r\nimport {httpService} from './http.service'\r\n\r\nexport const SOCKET_EMIT_USER_WATCH = 'user-watch';\r\nexport const SOCKET_EVENT_USER_UPDATED = 'user-updated';\r\nexport const SOCKET_EVENT_REVIEW_ADDED = 'review-added';\r\nexport const SOCKET_EVENT_REVIEW_ABOUT_YOU = 'review-about-you';\r\n\r\n\r\nconst baseUrl = (process.env.NODE_ENV === 'production')? '' : '//localhost:3030'\r\n// export const socketService = createSocketService()\r\nexport const socketService = createDummySocketService()\r\n\r\nwindow.socketService = socketService\r\n\r\n// var socketIsReady = false;\r\nsocketService.setup()\r\n\r\n\r\nfunction createSocketService() {\r\n  var socket = null;\r\n  const socketService = {\r\n    async setup() {\r\n      // YaronB: Need to send a dummy ajax request as to setup the socket-session correctly\r\n      // await httpService.get('setup-session')\r\n      // socket = io(baseUrl, { reconnection: false})\r\n      socket = io(baseUrl)\r\n      // socketIsReady = true;\r\n    },\r\n    on(eventName, cb) {\r\n      socket.on(eventName, cb)\r\n    },\r\n    off(eventName, cb=null) {\r\n      if (!socket) return;\r\n      if (!cb) socket.removeAllListeners(eventName)\r\n      else socket.off(eventName, cb)\r\n    },\r\n    emit(eventName, data) {\r\n      socket.emit(eventName, data)\r\n    },\r\n    terminate() {\r\n      socket = null\r\n    }\r\n  }\r\n  return socketService\r\n}\r\n\r\n// eslint-disable-next-line\r\nfunction createDummySocketService() {\r\n  var listenersMap = {}\r\n  const socketService = {\r\n    listenersMap,\r\n    setup() {\r\n      listenersMap = {}\r\n    },\r\n    terminate() {\r\n      this.setup()\r\n    },\r\n    on(eventName, cb) {\r\n      listenersMap[eventName] = [...(listenersMap[eventName]) || [], cb]\r\n    },\r\n    off(eventName, cb) {\r\n      if (!listenersMap[eventName]) return\r\n      if (!cb) delete listenersMap[eventName]\r\n      else listenersMap[eventName] = listenersMap[eventName].filter(l => l !== cb)\r\n    },\r\n    emit(eventName, data) {\r\n      if (!listenersMap[eventName]) return\r\n      listenersMap[eventName].forEach(listener => {\r\n        listener(data)\r\n      })\r\n    },\r\n    debugMsg() {\r\n      this.emit('chat addMsg', {from: 'Someone', txt: 'Aha it worked!'})\r\n    },\r\n  }\r\n  return socketService\r\n}\r\n\r\n\r\n// Basic Tests\r\n// function cb(x) {console.log(x)}\r\n// socketService.on('baba', cb)\r\n// socketService.emit('baba', 'DATA')\r\n// socketService.off('baba', cb)\r\n\r\n"]}]}